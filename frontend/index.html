<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1,maximum-scale=1,user-scalable=no" />
  <title>GalaxyX AI â€” Premium</title>

<style>
/* ============================================================
   GALAXYX AI â€” FINAL PREMIUM UI (ChatGPT Style 2025)
============================================================ */

:root{
  --bg:#060607;
  --panel:#0d0d0e;
  --muted:#a0a6ab;
  --accent:#0ea5ff;
  --accent-glow:rgba(14,165,255,0.35);
  --bubble:#101113;
  --bubble-user:#0b61d8;
  --text:#e9eef4;
  --radius:16px;
  --font:"Inter",system-ui;
}

*{margin:0;padding:0;box-sizing:border-box}
html,body{height:100%;background:var(--bg);color:var(--text);font-family:var(--font);overflow:hidden}

/* APP LAYOUT */
.app{display:flex;width:100vw;height:100vh}

/* SIDEBAR */
.sidebar{
  width:280px;
  background:linear-gradient(180deg,#030304ee,#0a0a0bff);
  border-right:1px solid rgba(255,255,255,0.05);
  padding:18px;display:flex;flex-direction:column;
  transition:.25s ease;z-index:10003;
}
.brand{display:flex;gap:12px;align-items:center}
.logo{width:46px;height:46px;background:linear-gradient(135deg,var(--accent),#0064b8);
  border-radius:14px;display:flex;align-items:center;justify-content:center;
  font-weight:700;font-size:20px;box-shadow:0 6px 18px var(--accent-glow)}
.brand-title{font-size:18px;font-weight:600}
.brand-sub{font-size:12px;color:var(--muted)}

.btn.new-chat{
  margin-top:12px;padding:12px;border-radius:12px;font-weight:600;
  background:#000;border:1px solid rgba(255,255,255,0.06);cursor:pointer;
}
.btn.new-chat:hover{background:rgba(255,255,255,0.08)}

.search-wrap input{
  width:100%;margin-top:12px;padding:10px 14px;border-radius:10px;
  background:#0b0b0b;border:1px solid rgba(255,255,255,0.07);color:var(--text);
}

.chats{flex:1;overflow-y:auto;margin-top:10px;padding-right:4px}
.chat-item{padding:12px;display:flex;gap:12px;border-radius:12px;cursor:pointer}
.chat-item:hover{background:rgba(255,255,255,0.06)}
.chat-item.active{
  background:rgba(14,165,255,0.15);
  box-shadow:inset 0 0 4px rgba(14,165,255,0.25)
}

.avatar{
  width:40px;height:40px;background:#0f0f0f;border-radius:10px;
  display:flex;align-items:center;justify-content:center;font-size:14px;font-weight:600;
}

.meta .title{font-size:14px}
.meta .sub{font-size:12px;color:var(--muted)}

.sidebar-bottom{padding-top:14px;border-top:1px solid rgba(255,255,255,0.05)}
.footer-actions{display:flex;gap:10px}
.ghost{
  padding:8px 14px;border-radius:10px;background:transparent;
  border:1px solid rgba(255,255,255,0.08);color:var(--muted)
}
.danger{color:#ff7070;border-color:#ff707055}

/* MAIN WINDOW */
.main{flex:1;display:flex;flex-direction:column}

/* TOPBAR */
.topbar{
  height:64px;border-bottom:1px solid rgba(255,255,255,0.05);
  display:flex;align-items:center;justify-content:space-between;padding:0 22px;
}

.hamburger-btn{background:transparent;border:none;cursor:pointer;display:flex;flex-direction:column;gap:6px;padding:6px}
.hamburger-btn .line{height:3px;border-radius:3px;background:var(--text)}
.big{width:24px}
.small{width:16px}

.share-btn{
  background:transparent;border:none;padding:6px;border-radius:10px;
  color:var(--muted);cursor:pointer;
}
.share-btn:hover{background:rgba(255,255,255,0.05);color:white}

/* CHAT AREA */
.chat-area{flex:1;overflow-y:auto;padding-top:20px;display:flex;justify-content:center}
.messages{width:100%;max-width:900px;padding:0 22px 140px}
.welcome-card{
  padding:30px;background:rgba(255,255,255,0.02);
  border:1px solid rgba(255,255,255,0.05);
  border-radius:14px;text-align:center;
}

/* MESSAGE BUBBLES */
.msg-row{margin:16px 0;display:flex;gap:10px}
.msg-row.user{justify-content:flex-end}
.message{
  padding:12px 16px;max-width:75%;
  background:var(--bubble);border-radius:14px;font-size:15px;
}
.msg-row.user .message{
  background:var(--bubble-user);color:white;border-bottom-right-radius:6px;
}
.small-meta{font-size:11px;opacity:0.7;margin-left:6px}

/* COMPOSER */
.composer{
  position:fixed;left:280px;right:0;bottom:10px;
  background:#000; padding:10px 20px;border-top:1px solid rgba(255,255,255,0.05);
}
.composer-box{
  max-width:900px;margin:0 auto;display:flex;align-items:center;gap:10px;
}
#userInput{
  flex:1;padding:8px 12px;border-radius:14px;background:#0e0e0e;
  border:1px solid #1a1a1a;color:white;resize:none;font-size:14px;
  min-height:36px;max-height:140px;
}

.c-btn{
  width:36px;height:36px;border-radius:10px;background:#000;border:none;
  display:flex;align-items:center;justify-content:center;cursor:pointer;
}
.c-btn.send{
  width:42px;height:42px;border-radius:50%;background:var(--accent);
  box-shadow:0 6px 16px var(--accent-glow)
}
.c-btn.send svg{stroke:white}

.mic-recording{
  animation:pulse 0.8s infinite alternate;
  background:#ff3b3b!important;
  box-shadow:0 0 20px #ff3b3baa!important;
}
@keyframes pulse{
  from{transform:scale(1)}
  to{transform:scale(1.15)}
}

/* MOBILE */
@media(max-width:900px){
  .sidebar{position:fixed;left:0;height:100%;width:78%;transform:translateX(-100%)}
  .sidebar.open{transform:translateX(0)}
  .composer{left:0}
  .messages{padding:0 16px 120px}
}
</style>
</head>

<body>
<div class="app">

<!-- SIDEBAR -->
<aside class="sidebar" id="sidebar">
  <div class="brand">
    <div class="logo">X</div>
    <div>
      <div class="brand-title">GalaxyX AI</div>
      <div class="brand-sub">Premium Edition</div>
    </div>
  </div>

  <button id="newChatBtn" class="btn new-chat">+ New chat</button>

  <div class="search-wrap">
    <input id="searchInput" placeholder="Search chats" />
  </div>

  <nav id="chatsList" class="chats"></nav>

  <div class="sidebar-bottom">
    <div class="footer-actions">
      <button id="exportBtn" class="ghost">Export</button>
      <button id="clearBtn" class="ghost danger">Clear</button>
    </div>
  </div>
</aside>

<!-- MAIN -->
<main class="main">

  <header class="topbar">
    <div style="display:flex;align-items:center;gap:12px">
      <button id="menuBtn" class="hamburger-btn">
        <span class="line big"></span><span class="line small"></span>
      </button>
      <div style="font-size:18px;font-weight:600">GalaxyX AI</div>
    </div>

    <button id="shareBtn" class="share-btn">ðŸ”—</button>
  </header>

  <section class="chat-area">
    <div id="messages" class="messages">
      <div class="welcome-card">
        <h2>Welcome to GalaxyX AI ðŸš€</h2>
        <p style="color:var(--muted)">Ask anything or use voice input.</p>
      </div>
    </div>
  </section>

  <!-- COMPOSER -->
  <footer class="composer">
    <div class="composer-box">
      <button id="attachBtn" class="c-btn">ðŸ“Ž</button>
      <textarea id="userInput" placeholder="Ask anything..." rows="1"></textarea>
      <button id="micBtn" class="c-btn">ðŸŽ¤</button>
      <button id="sendBtn" class="c-btn send">âž¤</button>
    </div>
  </footer>

</main>
</div>

<script>
/* BACKEND URLs */
const CHAT_URL = "https://galaxy-ai-3.onrender.com/chat";
const STT_URL  = "https://galaxy-ai-3.onrender.com/stt";
const TTS_URL  = "https://galaxy-ai-3.onrender.com/tts";

const micBtn = document.getElementById("micBtn");
const sendBtn = document.getElementById("sendBtn");
const userInput = document.getElementById("userInput");
const messagesEl = document.getElementById("messages");

/* Add message to UI */
function appendMessage(text, role="ai") {
  const div = document.createElement("div");
  div.className = "msg-row " + (role==="user" ? "user" : "ai");
  div.innerHTML = `
    <div class="message">${text}</div>
    <div class="small-meta">${new Date().toLocaleTimeString()}</div>
  `;
  messagesEl.appendChild(div);
  document.querySelector(".chat-area").scrollTop = 999999;
}

/* ---------- TEXT SEND ---------- */
async function sendTextMessage() {
  const text = userInput.value.trim();
  if(!text) return;
  userInput.value = "";

  appendMessage(text, "user");

  const res = await fetch(CHAT_URL, {
    method:"POST",
    headers:{ "Content-Type":"application/json" },
    body:JSON.stringify({ text })
  });

  const data = await res.json();
  appendMessage(data.reply, "ai");

  playVoice(data.reply);
}

sendBtn.onclick = sendTextMessage;

/* ---------- TTS PLAY ---------- */
async function playVoice(text){
  const res = await fetch(TTS_URL, {
    method:"POST",
    headers:{ "Content-Type":"application/json" },
    body:JSON.stringify({ text })
  });
  const blob = await res.blob();
  const url = URL.createObjectURL(blob);
  new Audio(url).play();
}

/* ---------- VOICE RECORD (STT) ---------- */
micBtn.onclick = async () => {
  try {
    micBtn.classList.add("mic-recording");

    const stream = await navigator.mediaDevices.getUserMedia({audio:true});
    const recorder = new MediaRecorder(stream);

    let chunks = [];
    recorder.ondataavailable = e => chunks.push(e.data);

    recorder.onstop = async () => {
      micBtn.classList.remove("mic-recording");

      const audioBlob = new Blob(chunks, {type:"audio/mp3"});
      const fd = new FormData();
      fd.append("audio", audioBlob, "voice.mp3");

      const r = await fetch(STT_URL, { method:"POST", body:fd });
      const out = await r.json();

      const text = out.text || "";
      if(text){
        appendMessage(text, "user");
        userInput.value = text;
        sendTextMessage();
      }
    };

    recorder.start();
    setTimeout(()=>recorder.stop(), 3000);
  }
  catch(err){
    alert("Mic error: " + err);
  }
};
</script>

</body>
</html>
