<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1,maximum-scale=1,user-scalable=no" />
  <title>GalaxyX AI ‚Äî Premium</title>

<style>
/* ============================================================
   GALAXYX AI ‚Äî FIXED PREMIUM UI (2025 Edition)
============================================================ */

:root {
  --bg: #060607;
  --panel: #0d0d0e;
  --muted: #a0a6ab;
  --accent: #0ea5ff;
  --accent-glow: rgba(14,165,255,0.35);
  --bubble: #101113;
  --bubble-user: #0b61d8;
  --text: #e9eef4;
  --radius: 16px;
  --font: "Inter", system-ui;
}

/* RESET */
* { margin: 0; padding: 0; box-sizing: border-box; }
html, body {
  height: 100%;
  background: var(--bg);
  color: var(--text);
  font-family: var(--font);
  overflow: hidden;
  -webkit-font-smoothing: antialiased;
}

/* APP */
.app { display: flex; width: 100vw; height: 100vh; }

/* ============================================================
   SIDEBAR ‚Äî FIXED (NO TRANSPARENCY)
============================================================ */
.sidebar {
  width: 280px;
  background: var(--panel);   /* FIX */
  border-right: 1px solid rgba(255,255,255,0.05);
  padding: 18px;
  display: flex;
  flex-direction: column;
  transition: transform .25s ease;
  z-index: 9999;
}

.brand { display: flex; gap: 12px; align-items: center; }
.logo {
  width: 46px; height: 46px;
  background: linear-gradient(135deg, var(--accent), #0064b8);
  border-radius: 14px;
  font-weight: 700;
  font-size: 20px;
  display: flex; align-items: center; justify-content: center;
  box-shadow: 0 6px 18px var(--accent-glow);
}

.brand-title { font-size: 18px; font-weight: 600; }
.brand-sub  { font-size: 12px; color: var(--muted); }

/* New Chat Button */
.btn.new-chat {
  margin-top: 12px;
  padding: 12px;
  font-weight: 600;
  border-radius: 12px;
  border: 1px solid rgba(255,255,255,0.06);
  background: rgba(255,255,255,0.05);
  cursor: pointer;
}
.btn.new-chat:hover { background: rgba(255,255,255,0.12); }

/* SEARCH */
.search-wrap input {
  width: 100%;
  margin-top: 12px;
  padding: 10px 14px;
  border-radius: 10px;
  background: #0b0b0b;
  border: 1px solid rgba(255,255,255,0.12);
  color: var(--text);
}

/* CHAT LIST */
.chats { flex: 1; overflow-y: auto; margin-top: 10px; padding-right: 4px; }
.chat-item {
  padding: 12px; display: flex; gap: 12px;
  border-radius: 12px; cursor: pointer;
}
.chat-item:hover { background: rgba(255,255,255,0.06); }
.chat-item.active {
  background: rgba(14,165,255,0.15);
  box-shadow: inset 0 0 4px rgba(14,165,255,0.25);
}

.chat-item .avatar {
  width: 40px; height: 40px;
  background: #121212;
  border-radius: 10px;
  display: flex; align-items: center; justify-content: center;
  font-weight: 600;
}

.meta .title { font-size: 14px; }
.meta .sub { font-size: 12px; color: var(--muted); }

/* SIDEBAR BOTTOM */
.sidebar-bottom { padding-top: 14px; border-top: 1px solid rgba(255,255,255,0.05); }
.footer-actions { display: flex; gap: 10px; }

.ghost {
  padding: 8px 14px;
  border-radius: 10px;
  border: 1px solid rgba(255,255,255,0.08);
  background: transparent;
  color: var(--muted);
}
.ghost:hover { background: rgba(255,255,255,0.08); }
.danger { color: #ff6e6e; }

/* ============================================================
   MAIN ‚Äî TOP BAR (SHARE BUTTON FIXED)
============================================================ */
.main { flex: 1; display: flex; flex-direction: column; }

.topbar {
  height: 64px;
  border-bottom: 1px solid rgba(255,255,255,0.05);
  display: flex; align-items: center;
  justify-content: space-between;
  padding: 0 22px;
}

/* Hamburger */
.hamburger-btn { background: none; border: none; cursor: pointer; display: flex; flex-direction: column; gap: 6px; }
.hamburger-btn .line { height: 3px; border-radius: 3px; background: var(--text); }
.big { width: 24px; }
.small { width: 16px; }

/* SHARE button FIXED */
.share-btn {
  font-size: 22px;
  padding: 8px 12px;
  border-radius: 10px;
  background: rgba(255,255,255,0.07);
  border: 1px solid rgba(255,255,255,0.10);
  color: var(--text);
}
.share-btn:hover { background: rgba(255,255,255,0.15); }

/* ============================================================
   CHAT AREA
============================================================ */
.chat-area {
  flex: 1; overflow-y: auto; padding-top: 20px;
  display: flex; justify-content: center;
}

.messages {
  width: 100%; max-width: 900px;
  padding: 0 22px 220px !important;
}

.welcome-card {
  padding: 30px;
  background: rgba(255,255,255,0.03);
  border: 1px solid rgba(255,255,255,0.05);
  border-radius: 14px;
  text-align: center;
}

/* ============================================================
   CHAT BUBBLES
============================================================ */
.msg-row { margin: 14px 0; display: flex; gap: 10px; }
.msg-row.user { justify-content: flex-end; }

.message {
  padding: 12px 16px;
  max-width: 74%;
  border-radius: 14px;
  font-size: 10px;
  background: var(--bubble);
  border: 1px solid rgba(255,255,255,0.03);
  line-height: 1.2;
  word-break: break-word;
}

.msg-row.user .message { background: var(--bubble-user); color: white; }

.small-meta { font-size: 11px; opacity: 0.7; margin-left: 6px; }

/* ============================================================
   COMPOSER ‚Äî FIXED FOR MOBILE
============================================================ */
.composer {
  position: fixed;
  bottom: 0;
  left: 280px;    /* Desktop */
  right: 0;
  padding: 18px 0;
  background: rgba(0,0,0,0.55);
  backdrop-filter: blur(14px);
  display: flex; justify-content: center;
  border-top: 1px solid rgba(255,255,255,0.06);
  z-index: 999;
}

/* Mobile FIX */
@media(max-width:900px) {
  .sidebar { position: fixed; transform: translateX(-100%); }
  .sidebar.open { transform: translateX(0); }

  .composer { left: 0; }
}

/* Composer Box */
.composer-inner {
  width: 100%; max-width: 880px;
  background: #101113;
  border: 1px solid rgba(255,255,255,0.10);
  border-radius: 34px;
  padding: 10px 16px;
  display: flex; align-items: center; gap: 12px;
}

/* INPUT */
#userInput {
  flex: 1;
  background: transparent;
  border: none; outline: none;
  resize: none;
  padding: 4px 6px;
  color: white;
  font-size: 16px;
  max-height: 160px;
}

/* Buttons */
.composer-btn {
  width: 40px; height: 40px;
  border-radius: 50%;
  border: none;
  background: rgba(255,255,255,0.08);
  color: white;
  font-size: 20px;
  display: flex; align-items: center; justify-content: center;
}

.send-btn {
  width: 44px; height: 44px;
  border-radius: 50%;
  background: var(--accent);
  color: white;
  border: none; cursor: pointer;
  font-size: 20px;
  box-shadow: 0 8px 20px rgba(14,165,255,0.45);
}
.send-btn:active { transform: scale(0.92); }

/* Scrollbar */
::-webkit-scrollbar { width: 6px; }
::-webkit-scrollbar-thumb { background: rgba(255,255,255,0.05); border-radius: 10px; }

</style>
</head>


<body>
<div class="app">

<!-- SIDEBAR -->
<aside class="sidebar" id="sidebar">
  <div class="brand">
    <div class="logo">X</div>
    <div>
      <div class="brand-title">GalaxyX AI</div>
      <div class="brand-sub">Premium Edition</div>
    </div>
  </div>

  <button id="newChatBtn" class="btn new-chat">+ New chat</button>

  <div class="search-wrap">
    <input id="searchInput" placeholder="Search chats" autocomplete="off" />
  </div>

  <nav id="chatsList" class="chats"></nav>

  <div class="sidebar-bottom">
    <div class="footer-actions">
      <button id="exportBtn" class="ghost">Export</button>
      <button id="clearBtn" class="ghost danger">Clear</button>
    </div>
  </div>
</aside>


<!-- MAIN -->
<main class="main">

  <header class="topbar">
    <div style="display:flex;align-items:center;gap:12px">
      <button id="menuBtn" class="hamburger-btn">
        <span class="line big"></span>
        <span class="line small"></span>
      </button>
      <div style="font-size:18px;font-weight:600">GalaxyX AI</div>
    </div>

    <button id="shareBtn" class="share-btn">‚§¥</button>
  </header>

  <section class="chat-area">
    <div id="messages" class="messages">
      <div class="welcome-card">
        <h2>Welcome to GalaxyX AI üöÄ</h2>
        <p style="color:var(--muted)">Type your message below.</p>
      </div>
    </div>
  </section>

  <!-- COMPOSER -->
  <footer class="composer">
    <div class="composer-inner">
      <button id="attachBtn" class="composer-btn">Ôºã</button>

      <textarea id="userInput" placeholder="Ask anything" rows="1"></textarea>

      <button id="micBtn" class="composer-btn">üéôÔ∏è</button>

      <button id="sendBtn" class="send-btn">‚û§</button>
    </div>
  </footer>

</main>
</div>



<!-- JS PART ‚Äî SAME AS YOUR ORIGINAL (No breaking changes) -->
<script>

const API_URL = "https://galaxy-ai-3.onrender.com/chat";

const chatsList = document.getElementById("chatsList");
const newChatBtn = document.getElementById("newChatBtn");
const searchInput = document.getElementById("searchInput");
const messagesEl = document.getElementById("messages");
const userInput = document.getElementById("userInput");
const sendBtn = document.getElementById("sendBtn");
const clearBtn = document.getElementById("clearBtn");
const exportBtn = document.getElementById("exportBtn");
const attachBtn = document.getElementById("attachBtn");
const micBtn = document.getElementById("micBtn");
const shareBtn = document.getElementById("shareBtn");
const menuBtn = document.getElementById("menuBtn");
const sidebar = document.getElementById("sidebar");

let chats = JSON.parse(localStorage.getItem("gx_chats") || "[]");
let activeChatId = null;

const uid = () => Date.now().toString(36) + Math.random().toString(36).slice(2, 6);
const nowTime = () => new Date().toLocaleTimeString([], { hour: "2-digit", minute: "2-digit" });

menuBtn.onclick = () => sidebar.classList.toggle("open");

document.addEventListener("click", (e) => {
  if (window.innerWidth <= 900 && !sidebar.contains(e.target) && e.target !== menuBtn) {
    sidebar.classList.remove("open");
  }
});

function save() {
  localStorage.setItem("gx_chats", JSON.stringify(chats));
}

function findChat(id) {
  return chats.find(c => c.id === id);
}

function escapeHTML(str) {
  return str.replace(/</g, "&lt;").replace(/>/g, "&gt;");
}

function renderChatList(filter = "") {
  chatsList.innerHTML = "";
  chats.slice().reverse().filter(c =>
    (c.title || "").toLowerCase().includes(filter.toLowerCase())
  )
  .forEach(chat => {
    const div = document.createElement("div");
    div.className = "chat-item";
    if (activeChatId === chat.id) div.classList.add("active");

    div.innerHTML = `
      <div class="avatar">${(chat.title || "C").slice(0,2).toUpperCase()}</div>
      <div class="meta">
        <div class="title">${chat.title || "New chat"}</div>
        <div class="sub">${chat.last || "No messages yet"}</div>
      </div>
    `;

    div.onclick = () => openChat(chat.id);
    chatsList.appendChild(div);
  });
}

function openChat(id) {
  activeChatId = id;
  const chat = findChat(id);
  messagesEl.innerHTML = "";

  if (!chat || !chat.messages.length) {
    messagesEl.innerHTML = `
      <div class="welcome-card">
        <h2>Welcome to GalaxyX AI üöÄ</h2>
      </div>`;
  } else {
    chat.messages.forEach(m => appendMessage(m.text, m.role, m.time));
  }

  renderChatList();
  scrollToBottom();
}

function appendMessage(text, role = "ai", time = nowTime()) {
  const div = document.createElement("div");
  div.className = "msg-row " + (role === "user" ? "user" : "ai");

  div.innerHTML = `
    <div class="message">${escapeHTML(text)}</div>
    <div class="small-meta">${time}</div>
  `;

  messagesEl.appendChild(div);
  scrollToBottom();
}

function scrollToBottom() {
  setTimeout(() => {
    document.querySelector(".chat-area").scrollTop =
      document.querySelector(".chat-area").scrollHeight;
  }, 50);
}

function newChat() {
  const id = uid();
  chats.push({ id, title: "New chat", last: "", messages: [] });
  save();
  renderChatList();
  openChat(id);
}

userInput.oninput = () => {
  userInput.style.height = "auto";
  userInput.style.height = Math.min(160, userInput.scrollHeight) + "px";
};

async function sendMessage() {
  const text = userInput.value.trim();
  if (!text) return;

  if (!activeChatId) newChat();
  const chat = findChat(activeChatId);

  const t = nowTime();
  chat.messages.push({ role: "user", text, time: t });
  chat.last = text.slice(0, 40);

  appendMessage(text, "user", t);
  userInput.value = "";
  userInput.style.height = "auto";
  save();

  try {
    const res = await fetch(API_URL, {
      method: "POST",
      headers: { "Content-Type": "application/json" },
      body: JSON.stringify({ text })
    });

    const json = await res.json();
    const reply = json.reply || "No response";

    const rt = nowTime();
    chat.messages.push({ role: "ai", text: reply, time: rt });
    chat.last = reply.slice(0, 50);
    appendMessage(reply, "ai", rt);
    save();
    renderChatList();

  } catch (err) {
    appendMessage("‚ö† Error: " + err.message, "ai", nowTime());
  }
}

/* EVENTS */
sendBtn.onclick = sendMessage;
newChatBtn.onclick = newChat;
clearBtn.onclick = () => { chats = []; save(); newChat(); };
exportBtn.onclick = () => {
  const a = document.createElement("a");
  a.href = URL.createObjectURL(new Blob([JSON.stringify(chats, null, 2)]));
  a.download = "chats.json";
  a.click();
};
searchInput.oninput = (e) => renderChatList(e.target.value);

/* INIT */
(function () {
  if (!chats.length) newChat();
  else { renderChatList(); openChat(chats[chats.length - 1].id); }
})();

</script>

</body>
</html>
