<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1,maximum-scale=1,user-scalable=no" />
  <title>GalaxyX AI â€” Premium</title>

<style>
/* ============================================================
   GALAXYX AI â€” FINAL PREMIUM UI (ChatGPT Style 2025)
============================================================ */

:root{
  --bg:#060607;
  --panel:#0d0d0e;
  --muted:#a0a6ab;
  --accent:#0ea5ff;
  --accent-glow:rgba(14,165,255,0.35);
  --bubble:#101113;
  --bubble-user:#0b61d8;
  --text:#e9eef4;
  --radius:16px;
  --font:"Inter",system-ui;
}

/* RESET */
*{margin:0;padding:0;box-sizing:border-box}
html,body{height:100%;background:var(--bg);color:var(--text);font-family:var(--font);overflow:hidden}

/* APP */
.app{display:flex;width:100vw;height:100vh}

/* SIDEBAR */
.sidebar{
  width:280px;
  background:linear-gradient(180deg,#030304,#0a0a0b);
  border-right:1px solid rgba(255,255,255,0.05);
  padding:18px;
  display:flex;
  flex-direction:column;
  transition:.25s ease;
  z-index:10003;
}
.brand{display:flex;gap:12px;align-items:center}
.logo{width:46px;height:46px;background:linear-gradient(135deg,var(--accent),#0064b8);border-radius:14px;display:flex;align-items:center;justify-content:center;font-weight:700;font-size:20px;box-shadow:0 6px 18px var(--accent-glow)}
.brand-title{font-size:18px;font-weight:600}
.brand-sub{font-size:12px;color:var(--muted)}

.btn.new-chat{
  margin-top:12px;padding:12px;border-radius:12px;
  font-weight:600;background:#000;border:1px solid rgba(255,255,255,0.06);
}
.btn.new-chat:hover{background:rgba(255,255,255,0.08)}

.search-wrap input{
  width:100%;margin-top:12px;padding:10px 14px;
  border-radius:10px;background:#0b0b0b;border:1px solid rgba(255,255,255,0.07);color:var(--text);
}

.chats{flex:1;overflow-y:auto;margin-top:10px;padding-right:4px}
.chat-item{
  padding:12px;display:flex;gap:12px;border-radius:12px;cursor:pointer;
}
.chat-item:hover{background:rgba(255,255,255,0.06)}
.chat-item.active{
  background:rgba(14,165,255,0.15);
  box-shadow:inset 0 0 4px rgba(14,165,255,0.25);
}
.chat-item .avatar{
  width:40px;height:40px;background:#0f0f0f;border-radius:10px;display:flex;align-items:center;justify-content:center;font-size:14px;font-weight:600;
}

.meta .title{font-size:14px}
.meta .sub{font-size:12px;color:var(--muted)}

.sidebar-bottom{padding-top:14px;border-top:1px solid rgba(255,255,255,0.05)}
.footer-actions{display:flex;gap:10px}
.ghost{
  padding:8px 14px;border-radius:10px;background:transparent;
  border:1px solid rgba(255,255,255,0.08);color:var(--muted);
}
.ghost:hover{background:rgba(255,255,255,0.08)}
.danger{color:#ff7070;border-color:#ff707055}

/* MAIN */
.main{flex:1;display:flex;flex-direction:column}

/* TOPBAR */
.topbar{
  height:64px;border-bottom:1px solid rgba(255,255,255,0.05);
  display:flex;align-items:center;justify-content:space-between;padding:0 22px;
}

.hamburger-btn{
  background:none;border:none;cursor:pointer;display:flex;flex-direction:column;gap:6px;padding:6px;
}
.hamburger-btn .line{height:3px;border-radius:3px;background:var(--text)}
.big{width:24px}
.small{width:16px}

/* SHARE */
.share-btn{
  background:none;border:none;padding:6px;border-radius:10px;
  cursor:pointer;color:var(--muted);transition:.2s;
}
.share-btn:hover{
  background:rgba(255,255,255,0.05);
  color:var(--text);
}

/* CHAT */
.chat-area{
  flex:1;overflow-y:auto;padding-top:20px;display:flex;justify-content:center;
}
.messages{
  width:100%;max-width:900px;padding:0 22px 140px;
}
.welcome-card{
  padding:30px;background:rgba(255,255,255,0.02);
  border:1px solid rgba(255,255,255,0.05);
  border-radius:14px;text-align:center;
}

/* MSG */
.msg-row{margin:16px 0;display:flex;gap:10px}
.msg-row.user{justify-content:flex-end}
.message{
  padding:12px 16px;max-width:75%;font-size:15px;background:var(--bubble);
  border-radius:14px;border:1px solid rgba(255,255,255,0.03);
}
.msg-row.user .message{
  background:var(--bubble-user);color:white;
  border-bottom-right-radius:6px;box-shadow:0 4px 12px rgba(0,80,200,0.2);
}
.small-meta{font-size:11px;opacity:0.7;margin-left:6px}

/* COMPOSER */
.composer{
  position:fixed;left:280px;right:0;bottom:10px;
  background:#000000e8;padding:10px 20px;
  border-top:1px solid rgba(255,255,255,0.05);
}
.composer-box{
  max-width:900px;margin:auto;display:flex;align-items:center;gap:10px;width:100%;
}
#userInput{
  flex:1;padding:8px 12px;border-radius:14px;background:#0e0e0e;
  border:1px solid #1a1a1a;color:white;resize:none;font-size:14px;
  min-height:36px;max-height:140px;
}
.c-btn{
  width:36px;height:36px;border-radius:10px;background:#000;border:none;
  display:flex;align-items:center;justify-content:center;cursor:pointer;
}
.c-btn.send{
  width:38px;height:38px;border-radius:50%;background:var(--accent);
  box-shadow:0 6px 16px var(--accent-glow);color:white;
}

/* MOBILE */
@media(max-width:900px){
  .sidebar{position:fixed;left:0;top:0;height:100%;transform:translateX(-100%)}
  .sidebar.open{transform:translateX(0)}
  .composer{left:0;padding:10px 16px}
  .messages{padding:0 16px 110px}
  .message{max-width:85%}
}
</style>
</head>


<body>
<div class="app">

<!-- SIDEBAR -->
<aside class="sidebar" id="sidebar">
  <div class="brand">
    <div class="logo">X</div>
    <div>
      <div class="brand-title">GalaxyX AI</div>
      <div class="brand-sub">Premium Edition</div>
    </div>
  </div>

  <button id="newChatBtn" class="btn new-chat">+ New chat</button>

  <div class="search-wrap">
    <input id="searchInput" placeholder="Search chats" />
  </div>

  <nav id="chatsList" class="chats"></nav>

  <div class="sidebar-bottom">
    <div class="footer-actions">
      <button id="exportBtn" class="ghost">Export</button>
      <button id="clearBtn" class="ghost danger">Clear</button>
    </div>
  </div>
</aside>


<!-- MAIN -->
<main class="main">
  <header class="topbar">
    <div style="display:flex;align-items:center;gap:12px">
      <button id="menuBtn" class="hamburger-btn">
        <span class="line big"></span>
        <span class="line small"></span>
      </button>
      <div style="font-size:18px;font-weight:600">GalaxyX AI</div>
    </div>

    <button id="shareBtn" class="share-btn">
      <svg width="22" height="22" viewBox="0 0 24 24" stroke="currentColor">
        <circle cx="18" cy="5" r="3"></circle>
        <circle cx="6" cy="12" r="3"></circle>
        <circle cx="18" cy="19" r="3"></circle>
        <line x1="8.7" y1="10.8" x2="15.3" y2="6.2"></line>
        <line x1="8.7" y1="13.2" x2="15.3" y2="17.8"></line>
      </svg>
    </button>
  </header>

  <section class="chat-area">
    <div id="messages" class="messages">
      <div class="welcome-card">
        <h2>Welcome to GalaxyX AI ðŸš€</h2>
        <p style="color:var(--muted)">Type your message below.</p>
      </div>
    </div>
  </section>

  <footer class="composer">
    <div class="composer-box">

      <button id="attachBtn" class="c-btn">
        +
      </button>

      <textarea id="userInput" placeholder="Ask anything..." rows="1"></textarea>

      <button id="micBtn" class="c-btn">
        ðŸŽ¤
      </button>

      <button id="sendBtn" class="c-btn send">âž¤</button>

    </div>
  </footer>
</main>

</div>

<script>
/* ============================================================
   JS â€” LOCAL BACKEND VERSION (FIXED)
============================================================ */

// ðŸ”¥ LOCAL BACKEND PE POINT KAR DIYA â€“ ab tera Ollama chalega!
const API_URL = "http://127.0.0.1:8000/chat";  // Local FastAPI backend

const chatsList = document.getElementById("chatsList");
const newChatBtn = document.getElementById("newChatBtn");
const searchInput = document.getElementById("searchInput");
const messagesEl = document.getElementById("messages");
const userInput = document.getElementById("userInput");
const sendBtn = document.getElementById("sendBtn");
const clearBtn = document.getElementById("clearBtn");
const exportBtn = document.getElementById("exportBtn");
const attachBtn = document.getElementById("attachBtn");
const micBtn = document.getElementById("micBtn");
const shareBtn = document.getElementById("shareBtn");
const menuBtn = document.getElementById("menuBtn");
const sidebar = document.getElementById("sidebar");

let chats = JSON.parse(localStorage.getItem("gx_chats") || "[]");
let activeChatId = null;

const uid = () => Date.now().toString(36) + Math.random().toString(36).slice(2,6);
const nowTime = () => new Date().toLocaleTimeString([], {hour:"2-digit", minute:"2-digit"});

function save(){ localStorage.setItem("gx_chats", JSON.stringify(chats)); }
function findChat(id){ return chats.find(c => c.id === id); }

/* MOBILE SIDEBAR */
menuBtn.onclick = () => {
  sidebar.classList.toggle("open");
  document.body.classList.toggle("mobile-open");
};

/* CLICK OUTSIDE CLOSE */
document.addEventListener("click", (e)=>{
  if (window.innerWidth <= 900 && !sidebar.contains(e.target) && e.target !== menuBtn){
    sidebar.classList.remove("open");
    document.body.classList.remove("mobile-open");
  }
});

function escapeHTML(t){ return t.replace(/</g,"&lt;").replace(/>/g,"&gt;"); }

function renderChatList(filter=""){
  chatsList.innerHTML = "";
  chats.slice().reverse().forEach(chat=>{
    const div = document.createElement("div");
    div.className = "chat-item" + (chat.id===activeChatId?" active":"");

    div.innerHTML = `
      <div class="avatar">${(chat.title||"C").slice(0,2).toUpperCase()}</div>
      <div class="meta">
        <div class="title">${chat.title}</div>
        <div class="sub">${chat.last || "No messages yet"}</div>
      </div>
    `;

    div.onclick = ()=>openChat(chat.id);
    chatsList.appendChild(div);
  });
}

function openChat(id){
  activeChatId = id;
  const chat = findChat(id);

  messagesEl.innerHTML = "";
  if (!chat || !chat.messages.length){
    messagesEl.innerHTML = `
      <div class="welcome-card">
        <h2>Welcome to GalaxyX AI ðŸš€</h2>
        <p style="color:var(--muted)">Type your message below.</p>
      </div>`;
  } else {
    chat.messages.forEach(m=>appendMessage(m.text,m.role,m.time));
  }

  renderChatList();
  scrollBottom();
}

function appendMessage(text,role,time){
  const row = document.createElement("div");
  row.className = "msg-row " + (role==="user" ? "user" : "ai");

  row.innerHTML = `
    <div class="message">${escapeHTML(text)}</div>
    <div class="small-meta">${time}</div>
  `;

  messagesEl.appendChild(row);
  scrollBottom();
}

function scrollBottom(){
  setTimeout(()=>{
    const area = document.querySelector(".chat-area");
    area.scrollTop = area.scrollHeight;
  },30);
}

function newChat(){
  const id = uid();
  chats.push({id,title:"New chat",last:"",messages:[]});
  save();renderChatList();openChat(id);
}

/* AUTO RESIZE */
userInput.oninput = ()=>{
  userInput.style.height="auto";
  userInput.style.height=Math.min(140,userInput.scrollHeight)+"px";
};

/* SEND MESSAGE */
async function sendMessage(){
  const text = userInput.value.trim();
  if (!text) return;

  if (!activeChatId) newChat();

  const chat = findChat(activeChatId);
  const time = nowTime();

  chat.messages.push({role:"user",text,time});
  chat.last = text.slice(0,40);
  appendMessage(text,"user",time);
  save();

  userInput.value="";
  userInput.style.height="auto";

  try{
    const res = await fetch(API_URL,{
      method:"POST",
      headers:{"Content-Type":"application/json"},
      body:JSON.stringify({text})
    });
    const json = await res.json();

    const reply = json.reply || "No response received.";
    const rt = nowTime();

    chat.messages.push({role:"ai",text:reply,time:rt});
    chat.last = reply.slice(0,40);
    appendMessage(reply,"ai",rt);

    save();renderChatList();
  }
  catch(err){
    appendMessage("âš  Server error: " + err.message + " (Ollama serve chal raha hai check kar)","ai",nowTime());
  }
}

sendBtn.onclick = sendMessage;
userInput.addEventListener("keydown", (e) => {
  if (e.key === "Enter" && !e.shiftKey) {
    e.preventDefault();
    sendMessage();
  }
});

/* MIC BUTTON â€” OPEN JARVIS PAGE */
micBtn.onclick = () => {
  micBtn.animate([
    {transform:"scale(1)"},
    {transform:"scale(0.9)"},
    {transform:"scale(1)"}
  ],{duration:200});

  window.location.href = "voice.html";  // ðŸ”¥ FINAL WORKING FIX
};

attachBtn.onclick = () => {
  attachBtn.animate([{transform:"rotate(0deg)"},{transform:"rotate(15deg)"},{transform:"rotate(0deg)"}],{duration:200});
};

/* SHARE BUTTON */
shareBtn.onclick = ()=>{
  alert("Share feature coming soon!");
};

/* CLEAR */
clearBtn.onclick = ()=>{ chats=[];save();newChat(); };

/* EXPORT */
exportBtn.onclick = ()=>{
  const a=document.createElement("a");
  a.href = URL.createObjectURL(new Blob([JSON.stringify(chats,null,2)]));
  a.download="chats.json";
  a.click();
};

searchInput.oninput = e => renderChatList(e.target.value);

/* INIT */
(function init(){
  if (!chats.length) newChat();
  else{ renderChatList(); openChat(chats[chats.length-1].id); }
})();
</script>

</body>
</html>